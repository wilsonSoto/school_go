"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8606],{8606:(V,v,a)=>{a.r(v),a.d(v,{DriverPageModule:()=>X,HttpLoaderFactory:()=>y});var n=a(7125),h=a(8834),g=a(9417),m=a(5528),f=a(467),e=a(9498),p=a(7408),P=a(3975),R=a(2167),F=a(8397),j=a(3067),k=a(5690);function D(i,l){1&i&&(e.j41(0,"div",19),e.nrm(1,"ion-spinner",20),e.j41(2,"p"),e.EFF(3,"Cargando Rutas..."),e.k0s()())}function S(i,l){if(1&i){const r=e.RV6();e.j41(0,"div",21),e.nrm(1,"ion-icon",22),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"ion-button",23),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.getAllRoute())}),e.EFF(5,"Reintentar"),e.k0s()()}if(2&i){const r=e.XpG();e.R7$(3),e.JRh(r.errorMessage)}}function C(i,l){1&i&&(e.j41(0,"div",24),e.nrm(1,"ion-icon",25),e.j41(2,"p"),e.EFF(3,"No hay informaci\xf3n disponible para esta secci\xf3n."),e.k0s()())}function G(i,l){if(1&i){const r=e.RV6();e.j41(0,"app-all-route",29),e.bIt("click",function(){const t=e.eBV(r).$implicit,s=e.XpG(2);return e.Njj(s.handleOpenRouteModal("edit",t))}),e.k0s()}2&i&&e.Y8G("route",l.$implicit)}function I(i,l){if(1&i){const r=e.RV6();e.j41(0,"app-all-route",29),e.bIt("click",function(){const t=e.eBV(r).$implicit,s=e.XpG(2);return e.Njj(s.handleOpenRouteModal("edit",t))}),e.k0s()}2&i&&e.Y8G("route",l.$implicit)}function M(i,l){if(1&i&&(e.j41(0,"ion-segment-view")(1,"ion-segment-content",26),e.DNE(2,G,1,1,"app-all-route",27),e.k0s(),e.j41(3,"ion-segment-content",28),e.DNE(4,I,1,1,"app-all-route",27),e.k0s()()),2&i){const r=e.XpG();e.R7$(2),e.Y8G("ngForOf",r.filtered_pickup),e.R7$(2),e.Y8G("ngForOf",r.filtered_delivery)}}function T(i,l){if(1&i){const r=e.RV6();e.j41(0,"ion-content")(1,"ion-list")(2,"ion-item",30),e.bIt("click",function(){e.eBV(r);const t=e.XpG();return e.Njj(t.logoutAndGoToSignIn())}),e.EFF(3,"Cerrar Sesi\xf3n"),e.k0s()()()}2&i&&(e.R7$(2),e.Y8G("button",!0)("detail",!1))}const $=[{path:"",component:(()=>{var i;class l{constructor(o,t,s,u,d,c){this.translate=o,this.router=t,this.routeService=s,this.toastService=u,this.authService=d,this.modalController=c,this.typeSelect="first",this.hasData=!0,this.userData="",this.students=[],this.school_routes_pickup=[],this.school_routes_delivery=[],this.isLoading=!0,this.errorMessage=null,this.searchTerm="",this.filtered_pickup=[],this.filtered_delivery=[]}logoutAndGoToSignIn(){var o=this;return(0,f.A)(function*(){yield o.authService.logout(),o.router.navigate(["/sign-in"])})()}changeLanguage(o){this.translate.use(o="es"==o?"en":"es")}ionViewWillEnter(){var o=this;return(0,f.A)(function*(){var t;o.userData=yield null===(t=JSON.parse(localStorage.getItem("userData")||"null"))||void 0===t?void 0:t.userInfo,o.getAllRoute()})()}handleSegmentChange(o){const t=o.detail.value;this.typeSelect=t,this.hasData="first"===t?this.school_routes_pickup.length>0:this.school_routes_delivery.length>0}handleRefresh(o){this.getAllRoute(),setTimeout(()=>{o.target.complete()},2e3)}filterRoutes(o){const t=(o.target.value||"").toLowerCase();if(this.searchTerm=t,!t)return this.filtered_pickup=[...this.school_routes_pickup],this.filtered_delivery=[...this.school_routes_delivery],void(this.hasData="first"===this.typeSelect?this.filtered_pickup.length>0:this.filtered_delivery.length>0);const s=u=>{var d,c;const Y=(null===(d=u.name)||void 0===d?void 0:d.toLowerCase())||"",O=(null===(c=u.school_driver)||void 0===c||null===(c=c.name)||void 0===c?void 0:c.toLowerCase())||"",x=(u.students||[]).map(B=>{var _;return(null===(_=B.name)||void 0===_?void 0:_.toLowerCase())||""}).join(" ");return Y.includes(t)||O.includes(t)||x.includes(t)};this.filtered_pickup=this.school_routes_pickup.filter(s),this.filtered_delivery=this.school_routes_delivery.filter(s),this.hasData="first"===this.typeSelect?this.filtered_pickup.length>0:this.filtered_delivery.length>0}getAllRoute(){this.isLoading=!0,this.errorMessage=null,this.routeService.getAllroute().subscribe({next:o=>{this.isLoading=!1,this.school_routes_pickup=o.data.school_routes.filter(t=>"Recogida"===t.route_type),this.school_routes_delivery=o.data.school_routes.filter(t=>"Recogida"!==t.route_type),this.filtered_pickup=[...this.school_routes_pickup],this.filtered_delivery=[...this.school_routes_delivery],this.hasData="first"===this.typeSelect?this.school_routes_pickup.length>0:this.school_routes_delivery.length>0},error:o=>{var t,s;this.isLoading=!1,this.errorMessage="Error al cargar las rutas: "+(o.message||"Error desconocido");const u=(null==o||null===(t=o.error)||void 0===t||null===(t=t.error)||void 0===t?void 0:t.message)||(null==o||null===(s=o.error)||void 0===s?void 0:s.error)||(null==o?void 0:o.message)||"Error desconocido";this.toastService.presentToast(u)}})}handleOpenRouteModal(o,t){t.id||console.log("error id route");const s=`/planned-route/${t.id}`;console.log(s,"[][[[[[][][][][][][][][][][]"),this.router.navigate([s],{queryParams:{action:o}})}}return(i=l).\u0275fac=function(o){return new(o||i)(e.rXU(p.c$),e.rXU(P.t),e.rXU(R.v),e.rXU(F.f),e.rXU(j.u),e.rXU(n.W3))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-route-page"]],standalone:!1,decls:29,vars:7,consts:[[1,"i-header"],[1,"i-toolbar-inner"],[1,"i-toolbar"],["size","large"],["size","auto"],["id","driver-bus-button"],["alt","Silhouette of a person's head","src","https://ionicframework.com/docs/img/demos/avatar.svg"],[1,"segment"],["size","mediun","mode","ios","show-clear-button","always","clear-icon","trash-bin","placeholder","Buscar por ruta, chofer o estudiante",3,"ionInput"],["size","large","mode","ios",3,"ngModelChange","ionChange","ngModel"],["value","first","content-id","first"],["value","second","content-id","second"],[1,"",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["class","loading-state ion-text-center",4,"ngIf"],["class","error-state ion-text-center",4,"ngIf"],["class","empty-state ion-text-center",4,"ngIf"],[4,"ngIf"],["trigger","driver-bus-button",3,"dismissOnSelect"],[1,"loading-state","ion-text-center"],["name","circles"],[1,"error-state","ion-text-center"],["name","warning-outline","color","danger"],[3,"click"],[1,"empty-state","ion-text-center"],["name","information-circle-outline","color","medium"],["id","first"],[3,"route","click",4,"ngFor","ngForOf"],["id","second"],[3,"click","route"],[3,"click","button","detail"]],template:function(o,t){1&o&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"ion-row",2)(4,"ion-col")(5,"ion-title",3),e.EFF(6,"Rutas programadas "),e.k0s()(),e.j41(7,"ion-col",4)(8,"div")(9,"ion-avatar",5),e.nrm(10,"img",6),e.k0s()()()()(),e.j41(11,"div",7)(12,"ion-searchbar",8),e.bIt("ionInput",function(u){return t.filterRoutes(u)}),e.k0s(),e.j41(13,"ion-segment",9),e.mxI("ngModelChange",function(u){return e.DH7(t.typeSelect,u)||(t.typeSelect=u),u}),e.bIt("ionChange",function(u){return t.handleSegmentChange(u)}),e.j41(14,"ion-segment-button",10)(15,"ion-label"),e.EFF(16,"Recogida "),e.k0s()(),e.j41(17,"ion-segment-button",11)(18,"ion-label"),e.EFF(19,"Entrega"),e.k0s()()()()()(),e.j41(20,"ion-content",12)(21,"ion-refresher",13),e.bIt("ionRefresh",function(u){return t.handleRefresh(u)}),e.nrm(22,"ion-refresher-content"),e.k0s(),e.DNE(23,D,4,0,"div",14)(24,S,6,1,"div",15)(25,C,4,0,"div",16)(26,M,5,2,"ion-segment-view",17),e.k0s(),e.j41(27,"ion-popover",18),e.DNE(28,T,4,2,"ng-template"),e.k0s()),2&o&&(e.R7$(13),e.R50("ngModel",t.typeSelect),e.R7$(7),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",t.errorMessage),e.R7$(),e.Y8G("ngIf",!t.isLoading&&!t.hasData),e.R7$(),e.Y8G("ngIf",!t.isLoading&&t.hasData),e.R7$(),e.Y8G("dismissOnSelect",!0))},dependencies:[n.mC,n.Jm,n.hU,n.W9,n.eU,n.iq,n.uz,n.he,n.nf,n.To,n.Ki,n.ln,n.S1,n.Gp,n.eP,n.Z$,n.pf,n.w2,n.BC,n.ai,n.CF,n.Je,n.Gw,h.G,h.I,g.BC,g.vS,k.E],styles:["ion-toolbar[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{margin:0 5px}"]}),l})()}];let L=(()=>{var i;class l{}return(i=l).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[m.m.forChild($),m.m]}),l})();var E=a(5218),b=a(8041),N=a(1150);function y(i){return new E.s(i,"./assets/translate/",".json")}let X=(()=>{var i;class l{}return(i=l).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({providers:[R.v],imports:[n.bv,h.D,g.YN,L,g.X1,p.h.forRoot({defaultLanguage:"es",loader:{provide:p.Wr,useFactory:y,deps:[b.a]}}),N.G]}),l})()}}]);