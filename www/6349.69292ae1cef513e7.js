"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6349],{6349:(Z,F,a)=>{a.r(F),a.d(F,{HttpLoaderFactory:()=>P,Tab2PageModule:()=>Q});var o=a(7125),u=a(8834),v=a(9417),h=a(5528),m=a(467),E=a(7689),V=a(7468),D=a(8810),M=a(7673),j=a(6354),g=a(9437),k=a(8141),$=a(980),G=a(4033),e=a(9498),p=a(7408),R=a(3491),A=a(3067),I=a(3975),T=a(8397),f=a(7461);function y(t,s){if(1&t){const i=e.RV6();e.j41(0,"ion-card",1),e.bIt("click",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.showDetails())}),e.nrm(1,"ion-ripple-effect"),e.j41(2,"ion-card-header")(3,"ion-avatar"),e.nrm(4,"img",2),e.k0s(),e.j41(5,"span")(6,"ion-card-title"),e.EFF(7),e.k0s(),e.j41(8,"ion-card-subtitle"),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"p")(12,"ion-label"),e.EFF(13,"Capacidad: "),e.j41(14,"ion-note"),e.EFF(15),e.k0s()()(),e.j41(16,"p")(17,"ion-label"),e.EFF(18,"Color: "),e.j41(19,"ion-note"),e.EFF(20),e.k0s()()(),e.j41(21,"p")(22,"ion-label"),e.EFF(23,"Conductor Asignado: "),e.j41(24,"ion-note"),e.EFF(25),e.k0s()()(),e.j41(26,"p")(27,"ion-label"),e.EFF(28,"ID de la Placa: "),e.j41(29,"ion-note"),e.EFF(30),e.k0s()()()(),e.j41(31,"div",3),e.nrm(32,"ion-icon",4)(33,"ion-icon",4),e.k0s()()}if(2&t){const i=e.XpG();e.R7$(4),e.Y8G("src",i.currentVehicle.vehicule_image||"https://ionicframework.com/docs/img/demos/bus.png",e.B4B),e.R7$(3),e.JRh(i.currentVehicle.name),e.R7$(2),e.Lme("",i.currentVehicle.brand||"Marca no especificada"," - ",i.currentVehicle.model||"Modelo no especificado",""),e.R7$(6),e.SpI("",i.currentVehicle.people_capacity||"N/A"," personas"),e.R7$(5),e.JRh(i.currentVehicle.vehicle_color||"N/A"),e.R7$(5),e.JRh((null==i.currentVehicle.school_driver?null:i.currentVehicle.school_driver.name)||"N/A"),e.R7$(5),e.JRh(i.currentVehicle.name)}}let x=(()=>{var t;class s{constructor(n){this.translate=n,this.currentVehicle=null,this.handleActionDriver=new e.bkB}changeLanguage(n){this.translate.use(n="es"==n?"en":"es")}showDetails(){this.handleActionDriver.emit("edit")}}return(t=s).\u0275fac=function(n){return new(n||t)(e.rXU(p.c$))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-vehicles"]],inputs:{currentVehicle:"currentVehicle"},outputs:{handleActionDriver:"handleActionDriver"},standalone:!1,decls:1,vars:1,consts:[["class","ion-activatable ripple-parent ion-margin-top",3,"click",4,"ngIf"],[1,"ion-activatable","ripple-parent","ion-margin-top",3,"click"],["alt","Bus Image",3,"src"],[1,"card-footer-buttons"],["name","chevron-forward-outline"]],template:function(n,r){1&n&&e.DNE(0,y,34,8,"ion-card",0),2&n&&e.Y8G("ngIf",r.currentVehicle)},dependencies:[o.mC,o.b_,o.I9,o.ME,o.HW,o.tN,o.iq,o.he,o.JI,o.S7,u.I],styles:["ion-card[_ngcontent-%COMP%]{position:relative}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:64px;right:23px}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;margin:0 -6px}"]}),s})();function B(t,s){if(1&t){const i=e.RV6();e.j41(0,"ion-card",1),e.bIt("click",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.showDetails())}),e.nrm(1,"ion-ripple-effect"),e.j41(2,"ion-card-header")(3,"ion-avatar"),e.nrm(4,"img",2),e.k0s(),e.j41(5,"span")(6,"ion-card-title"),e.EFF(7),e.k0s(),e.j41(8,"ion-card-subtitle"),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"p")(12,"ion-label"),e.EFF(13,"Tel\xe9fono: "),e.j41(14,"ion-note"),e.EFF(15),e.k0s()()(),e.j41(16,"p")(17,"ion-label"),e.EFF(18,"M\xf3vil: "),e.j41(19,"ion-note"),e.EFF(20),e.k0s()()(),e.j41(21,"p")(22,"ion-label"),e.EFF(23,"Licencia: "),e.j41(24,"ion-note"),e.EFF(25),e.k0s()()(),e.j41(26,"p")(27,"ion-label"),e.EFF(28,"Direcci\xf3n: "),e.j41(29,"ion-note"),e.EFF(30),e.k0s()()()(),e.j41(31,"div",3),e.nrm(32,"ion-icon",4)(33,"ion-icon",4),e.k0s()()}if(2&t){const i=e.XpG();e.R7$(4),e.Y8G("src",i.currentDriver.profile||"https://ionicframework.com/docs/img/demos/avatar.svg",e.B4B),e.R7$(3),e.JRh(i.currentDriver.name),e.R7$(2),e.JRh(i.currentDriver.email),e.R7$(6),e.JRh(i.currentDriver.phone||"N/A"),e.R7$(5),e.JRh(i.currentDriver.mobile||"N/A"),e.R7$(5),e.JRh(i.currentDriver.driver_license||"N/A"),e.R7$(5),e.JRh(i.currentDriver.address||"N/A")}}let O=(()=>{var t;class s{constructor(n,r,l){this.translate=n,this.toastService=r,this.driversService=l,this.currentDriver=null,this.handleActionDriver=new e.bkB}changeLanguage(n){this.translate.use(n="es"==n?"en":"es")}showDetails(){this.handleActionDriver.emit("edit")}}return(t=s).\u0275fac=function(n){return new(n||t)(e.rXU(p.c$),e.rXU(T.f),e.rXU(f.h))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-drivers"]],inputs:{currentDriver:"currentDriver"},outputs:{handleActionDriver:"handleActionDriver"},standalone:!1,decls:1,vars:1,consts:[["class","ion-activatable ripple-parent ion-margin-top",3,"click",4,"ngIf"],[1,"ion-activatable","ripple-parent","ion-margin-top",3,"click"],["alt","Driver Profile",3,"src"],[1,"card-footer-buttons"],["name","chevron-forward-outline"]],template:function(n,r){1&n&&e.DNE(0,B,34,7,"ion-card",0),2&n&&e.Y8G("ngIf",r.currentDriver)},dependencies:[o.mC,o.b_,o.I9,o.ME,o.HW,o.tN,o.iq,o.he,o.JI,o.S7,u.I],styles:["ion-card[_ngcontent-%COMP%]{position:relative}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:64px;right:23px}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;margin:0 -6px}"]}),s})();const C=()=>["/add-bus"];function S(t,s){1&t&&(e.j41(0,"div",19),e.nrm(1,"ion-spinner",20),e.j41(2,"p"),e.EFF(3,"Cargando Rutas..."),e.k0s()())}function L(t,s){if(1&t){const i=e.RV6();e.j41(0,"div",21),e.nrm(1,"ion-icon",22),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"ion-button",23),e.bIt("click",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.loadDriversAndBuses())}),e.EFF(5,"Reintentar"),e.k0s()()}if(2&t){const i=e.XpG();e.R7$(3),e.JRh(i.errorMessage)}}function N(t,s){if(1&t){const i=e.RV6();e.j41(0,"app-drivers",28),e.bIt("handleActionDriver",function(r){const l=e.eBV(i).$implicit,c=e.XpG(2);return e.Njj(c.handleOpenDriverModal(r,l))}),e.k0s()}2&t&&e.Y8G("currentDriver",s.$implicit)}function X(t,s){if(1&t){const i=e.RV6();e.j41(0,"app-vehicles",29),e.bIt("handleActionDriver",function(r){const l=e.eBV(i).$implicit,c=e.XpG(2);return e.Njj(c.handleOpenBusModal(r,l))}),e.k0s()}2&t&&e.Y8G("currentVehicle",s.$implicit)}function Y(t,s){if(1&t&&(e.j41(0,"ion-segment-view")(1,"ion-segment-content",24),e.DNE(2,N,1,1,"app-drivers",25),e.k0s(),e.j41(3,"ion-segment-content",26),e.DNE(4,X,1,1,"app-vehicles",27),e.k0s()()),2&t){const i=e.XpG();e.R7$(2),e.Y8G("ngForOf",i.currentDrivers),e.R7$(2),e.Y8G("ngForOf",i.currentVehicles)}}function J(t,s){1&t&&(e.j41(0,"ion-fab",30)(1,"ion-fab-button",31),e.nrm(2,"ion-icon",32),e.k0s()()),2&t&&(e.R7$(),e.Y8G("routerLink",e.lJ4(1,C)))}function U(t,s){1&t&&(e.j41(0,"ion-fab",30)(1,"ion-fab-button",31),e.nrm(2,"ion-icon",32),e.k0s()()),2&t&&(e.R7$(),e.Y8G("routerLink",e.lJ4(1,C)))}function W(t,s){if(1&t){const i=e.RV6();e.j41(0,"ion-content")(1,"ion-list")(2,"ion-item",33),e.bIt("click",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.logoutAndGoToSignIn())}),e.EFF(3,"Cerrar Sesi\xf3n"),e.k0s()()()}2&t&&(e.R7$(2),e.Y8G("button",!0)("detail",!1))}const w=[{path:"",component:(()=>{var t;class s{constructor(n,r,l,c,d,b,_){this.translate=n,this.modalController=r,this.busService=l,this.authService=c,this.router=d,this.toastService=b,this.driversService=_,this.typeSelect="first",this.currentDrivers=[],this.currentVehicles=[],this.isLoading=!0,this.errorMessage=null}ionViewWillEnter(){console.log("Tab3Page: ionViewWillEnter - La p\xe1gina va a ser visible"),this.loadDriversAndBuses()}logoutAndGoToSignIn(){var n=this;return(0,m.A)(function*(){yield n.authService.logout(),n.router.navigate(["/sign-in"])})()}changeLanguage(n){this.translate.use(n="es"==n?"en":"es")}handleRefresh(n){this.loadDriversAndBuses(),setTimeout(()=>{n.target.complete()},2e3)}handleOpenDriverModal(n,r){var l=this;return(0,m.A)(function*(){try{const c=yield l.modalController.create({component:E.K,componentProps:{action:n,driver:r},initialBreakpoint:1,breakpoints:[0,1],cssClass:["loading-truck-options-sheet-modal"]});yield c.present();const{data:d}=yield c.onWillDismiss();if("cancel"===d.action)return}catch{}})()}handleOpenBusModal(n,r){var l=this;return(0,m.A)(function*(){try{const c=yield l.modalController.create({component:G.o,componentProps:{action:n,bus:r},initialBreakpoint:1,breakpoints:[0,1],cssClass:["loading-truck-options-sheet-modal"]});yield c.present();const{data:d}=yield c.onWillDismiss();if("cancel"===d.action)return}catch{}})()}loadDriversAndBuses(){this.isLoading=!0,this.errorMessage=null,(0,V.p)({drivers:this.driversService.getAllDrivers().pipe((0,j.T)(n=>{var r;return(null==n||null===(r=n.data)||void 0===r?void 0:r.school_drivers)||[]}),(0,g.W)(n=>(console.error("Error fetching drivers:",n),(0,D.$)(()=>new Error(n.message||"Failed to load drivers"))))),buses:this.busService.getAllBuses().pipe((0,j.T)(n=>{var r;return(null==n||null===(r=n.data)||void 0===r?void 0:r.school_buses)||[]}),(0,g.W)(n=>(console.error("Error fetching buses:",n),(0,D.$)(()=>new Error(n.message||"Failed to load buses")))))}).pipe((0,k.M)(n=>{this.currentDrivers=n.drivers,this.currentVehicles=n.buses}),(0,g.W)(n=>(console.error("Failed to load drivers or buses:",n),this.errorMessage="Error al cargar los conductores o autobuses: "+(n.message||"Error desconocido"),(0,M.of)(null))),(0,$.j)(()=>{this.isLoading=!1})).subscribe()}}return(t=s).\u0275fac=function(n){return new(n||t)(e.rXU(p.c$),e.rXU(o.W3),e.rXU(R.b),e.rXU(A.u),e.rXU(I.t),e.rXU(T.f),e.rXU(f.h))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-tab2"]],standalone:!1,decls:30,vars:8,consts:[[1,"i-header"],[1,"i-toolbar-inner"],[1,"i-toolbar"],["size","large"],["size","auto"],["id","driver-bus-button"],["alt","Silhouette of a person's head","src","https://ionicframework.com/docs/img/demos/avatar.svg"],[1,"segment"],["size","mediun","mode","ios","show-clear-button","always","clear-icon","trash-bin","value","Custom Clear Icon"],["size","large","mode","ios",3,"ngModelChange","ngModel"],["value","first","content-id","first"],["value","second","content-id","second"],[1,"",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["class","loading-state ion-text-center",4,"ngIf"],["class","error-state ion-text-center",4,"ngIf"],[4,"ngIf"],["slot","fixed","vertical","bottom","horizontal","end",4,"ngIf"],["trigger","driver-bus-button",3,"dismissOnSelect"],[1,"loading-state","ion-text-center"],["name","circles"],[1,"error-state","ion-text-center"],["name","warning-outline","color","danger"],[3,"click"],["id","first"],[3,"currentDriver","handleActionDriver",4,"ngFor","ngForOf"],["id","second"],[3,"currentVehicle","handleActionDriver",4,"ngFor","ngForOf"],[3,"handleActionDriver","currentDriver"],[3,"handleActionDriver","currentVehicle"],["slot","fixed","vertical","bottom","horizontal","end"],[3,"routerLink"],["name","add"],[3,"click","button","detail"]],template:function(n,r){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"ion-row",2)(4,"ion-col")(5,"ion-title",3),e.EFF(6," Choferes y Vehiculos "),e.k0s()(),e.j41(7,"ion-col",4)(8,"div")(9,"ion-avatar",5),e.nrm(10,"img",6),e.k0s()()()()(),e.j41(11,"div",7),e.nrm(12,"ion-searchbar",8),e.j41(13,"ion-segment",9),e.mxI("ngModelChange",function(c){return e.DH7(r.typeSelect,c)||(r.typeSelect=c),c}),e.j41(14,"ion-segment-button",10)(15,"ion-label"),e.EFF(16,"Choferes "),e.k0s()(),e.j41(17,"ion-segment-button",11)(18,"ion-label"),e.EFF(19,"Vehiculos"),e.k0s()()()()()(),e.j41(20,"ion-content",12)(21,"ion-refresher",13),e.bIt("ionRefresh",function(c){return r.handleRefresh(c)}),e.nrm(22,"ion-refresher-content"),e.k0s(),e.DNE(23,S,4,0,"div",14)(24,L,6,1,"div",15)(25,Y,5,2,"ion-segment-view",16)(26,J,3,2,"ion-fab",17)(27,U,3,2,"ion-fab",17),e.k0s(),e.j41(28,"ion-popover",18),e.DNE(29,W,4,2,"ng-template"),e.k0s()),2&n&&(e.R7$(13),e.R50("ngModel",r.typeSelect),e.R7$(7),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("ngIf",r.isLoading),e.R7$(),e.Y8G("ngIf",r.errorMessage),e.R7$(),e.Y8G("ngIf",!r.isLoading),e.R7$(),e.Y8G("ngIf",!r.isLoading),e.R7$(),e.Y8G("ngIf",!r.isLoading),e.R7$(),e.Y8G("dismissOnSelect",!0))},dependencies:[o.mC,o.Jm,o.hU,o.W9,o.Q8,o.YW,o.eU,o.iq,o.uz,o.he,o.nf,o.To,o.Ki,o.ln,o.S1,o.Gp,o.eP,o.Z$,o.pf,o.w2,o.BC,o.ai,o.CF,o.Je,o.Gw,o.N7,u.G,u.I,v.BC,v.vS,h.R,x,O],styles:["ion-toolbar[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{margin:0 11px 7px}"]}),s})()}];let z=(()=>{var t;class s{}return(t=s).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[h.m.forChild(w),h.m]}),s})();var H=a(5218),K=a(8041);function P(t){return new H.s(t,"./assets/translate/",".json")}let Q=(()=>{var t;class s{}return(t=s).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({providers:[f.h,R.b],imports:[o.bv,u.D,v.YN,z,v.X1,p.h.forRoot({defaultLanguage:"es",loader:{provide:p.Wr,useFactory:P,deps:[K.a]}})]}),s})()}}]);