"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6349],{6349:(Q,b,c)=>{c.r(b),c.d(b,{HttpLoaderFactory:()=>R,Tab2PageModule:()=>Z});var o=c(7125),v=c(8834),m=c(9417),D=c(5528),g=c(467),V=c(7689),P=c(7468),F=c(8810),E=c(7673),C=c(6354),f=c(9437),$=c(8141),y=c(980),M=c(4033),e=c(9498),p=c(4909),T=c(3491),I=c(3067),k=c(3975),j=c(8397),_=c(7461);function G(t,a){if(1&t){const r=e.RV6();e.j41(0,"ion-card",1),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.showDetails())}),e.nrm(1,"ion-ripple-effect"),e.j41(2,"ion-card-header")(3,"ion-avatar"),e.nrm(4,"img",2),e.k0s(),e.j41(5,"span")(6,"ion-card-title"),e.EFF(7),e.k0s(),e.j41(8,"ion-card-subtitle"),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"p")(12,"ion-label"),e.EFF(13,"Capacidad: "),e.j41(14,"ion-note"),e.EFF(15),e.k0s()()(),e.j41(16,"p")(17,"ion-label"),e.EFF(18,"Color: "),e.j41(19,"ion-note"),e.EFF(20),e.k0s()()(),e.j41(21,"p")(22,"ion-label"),e.EFF(23,"Conductor Asignado: "),e.j41(24,"ion-note"),e.EFF(25),e.k0s()()(),e.j41(26,"p")(27,"ion-label"),e.EFF(28,"ID de la Placa: "),e.j41(29,"ion-note"),e.EFF(30),e.k0s()()()(),e.j41(31,"div",3),e.nrm(32,"ion-icon",4)(33,"ion-icon",4),e.k0s()()}if(2&t){const r=e.XpG();e.R7$(4),e.Y8G("src",r.currentVehicle.vehicule_image||"https://ionicframework.com/docs/img/demos/bus.png",e.B4B),e.R7$(3),e.JRh(r.currentVehicle.name),e.R7$(2),e.Lme("",r.currentVehicle.brand||"Marca no especificada"," - ",r.currentVehicle.model||"Modelo no especificado",""),e.R7$(6),e.SpI("",r.currentVehicle.people_capacity||"N/A"," personas"),e.R7$(5),e.JRh(r.currentVehicle.vehicle_color||"N/A"),e.R7$(5),e.JRh((null==r.currentVehicle.school_driver?null:r.currentVehicle.school_driver.name)||"N/A"),e.R7$(5),e.JRh(r.currentVehicle.name)}}let A=(()=>{var t;class a{constructor(n){this.translate=n,this.currentVehicle=null,this.handleActionDriver=new e.bkB}changeLanguage(n){this.translate.use(n="es"==n?"en":"es")}showDetails(){this.handleActionDriver.emit("edit")}}return(t=a).\u0275fac=function(n){return new(n||t)(e.rXU(p.c$))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-vehicles"]],inputs:{currentVehicle:"currentVehicle"},outputs:{handleActionDriver:"handleActionDriver"},standalone:!1,decls:1,vars:1,consts:[["class","ion-activatable ripple-parent ion-margin-top",3,"click",4,"ngIf"],[1,"ion-activatable","ripple-parent","ion-margin-top",3,"click"],["alt","Bus Image",3,"src"],[1,"card-footer-buttons"],["name","chevron-forward-outline"]],template:function(n,i){1&n&&e.DNE(0,G,34,8,"ion-card",0),2&n&&e.Y8G("ngIf",i.currentVehicle)},dependencies:[o.mC,o.b_,o.I9,o.ME,o.HW,o.tN,o.iq,o.he,o.JI,o.S7,v.I],styles:["ion-card[_ngcontent-%COMP%]{position:relative}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:64px;right:23px}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;margin:0 -6px}"]}),a})();function S(t,a){if(1&t){const r=e.RV6();e.j41(0,"ion-card",1),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.showDetails())}),e.nrm(1,"ion-ripple-effect"),e.j41(2,"ion-card-header")(3,"ion-avatar"),e.nrm(4,"img",2),e.k0s(),e.j41(5,"span")(6,"ion-card-title"),e.EFF(7),e.k0s(),e.j41(8,"ion-card-subtitle"),e.EFF(9),e.k0s()()(),e.j41(10,"ion-card-content")(11,"p")(12,"ion-label"),e.EFF(13,"Tel\xe9fono: "),e.j41(14,"ion-note"),e.EFF(15),e.k0s()()(),e.j41(16,"p")(17,"ion-label"),e.EFF(18,"M\xf3vil: "),e.j41(19,"ion-note"),e.EFF(20),e.k0s()()(),e.j41(21,"p")(22,"ion-label"),e.EFF(23,"Licencia: "),e.j41(24,"ion-note"),e.EFF(25),e.k0s()()(),e.j41(26,"p")(27,"ion-label"),e.EFF(28,"Direcci\xf3n: "),e.j41(29,"ion-note"),e.EFF(30),e.k0s()()()(),e.j41(31,"div",3),e.nrm(32,"ion-icon",4)(33,"ion-icon",4),e.k0s()()}if(2&t){const r=e.XpG();e.R7$(4),e.Y8G("src",r.currentDriver.profile||"https://ionicframework.com/docs/img/demos/avatar.svg",e.B4B),e.R7$(3),e.JRh(r.currentDriver.name),e.R7$(2),e.JRh(r.currentDriver.email),e.R7$(6),e.JRh(r.currentDriver.phone||"N/A"),e.R7$(5),e.JRh(r.currentDriver.mobile||"N/A"),e.R7$(5),e.JRh(r.currentDriver.driver_license||"N/A"),e.R7$(5),e.JRh(r.currentDriver.address||"N/A")}}let x=(()=>{var t;class a{constructor(n,i,l){this.translate=n,this.toastService=i,this.driversService=l,this.currentDriver=null,this.handleActionDriver=new e.bkB}changeLanguage(n){this.translate.use(n="es"==n?"en":"es")}showDetails(){this.handleActionDriver.emit("edit")}}return(t=a).\u0275fac=function(n){return new(n||t)(e.rXU(p.c$),e.rXU(j.f),e.rXU(_.h))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-drivers"]],inputs:{currentDriver:"currentDriver"},outputs:{handleActionDriver:"handleActionDriver"},standalone:!1,decls:1,vars:1,consts:[["class","ion-activatable ripple-parent ion-margin-top",3,"click",4,"ngIf"],[1,"ion-activatable","ripple-parent","ion-margin-top",3,"click"],["alt","Driver Profile",3,"src"],[1,"card-footer-buttons"],["name","chevron-forward-outline"]],template:function(n,i){1&n&&e.DNE(0,S,34,7,"ion-card",0),2&n&&e.Y8G("ngIf",i.currentDriver)},dependencies:[o.mC,o.b_,o.I9,o.ME,o.HW,o.tN,o.iq,o.he,o.JI,o.S7,v.I],styles:["ion-card[_ngcontent-%COMP%]{position:relative}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;top:64px;right:23px}ion-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;margin:0 -6px}"]}),a})();function B(t,a){1&t&&(e.j41(0,"div",19),e.nrm(1,"ion-spinner",20),e.j41(2,"p"),e.EFF(3,"Cargando Rutas..."),e.k0s()())}function L(t,a){if(1&t){const r=e.RV6();e.j41(0,"div",21),e.nrm(1,"ion-icon",22),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"ion-button",23),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.loadDriversAndBuses())}),e.EFF(5,"Reintentar"),e.k0s()()}if(2&t){const r=e.XpG();e.R7$(3),e.JRh(r.errorMessage)}}function O(t,a){1&t&&(e.j41(0,"div",24),e.nrm(1,"ion-icon",25),e.j41(2,"p"),e.EFF(3,"No hay informaci\xf3n disponible para esta secci\xf3n."),e.k0s()())}function X(t,a){if(1&t){const r=e.RV6();e.j41(0,"app-drivers",30),e.bIt("handleActionDriver",function(i){const l=e.eBV(r).$implicit,s=e.XpG(3);return e.Njj(s.handleOpenDriverModal(i,l))}),e.k0s()}2&t&&e.Y8G("currentDriver",a.$implicit)}function N(t,a){if(1&t&&(e.j41(0,"ion-segment-content",28),e.DNE(1,X,1,1,"app-drivers",29),e.k0s()),2&t){const r=e.XpG(2);e.R7$(),e.Y8G("ngForOf",r.filteredDrivers)}}function w(t,a){if(1&t){const r=e.RV6();e.j41(0,"app-vehicles",33),e.bIt("handleActionDriver",function(i){const l=e.eBV(r).$implicit,s=e.XpG(3);return e.Njj(s.handleOpenBusModal(i,l))}),e.k0s()}2&t&&e.Y8G("currentVehicle",a.$implicit)}function Y(t,a){if(1&t&&(e.j41(0,"ion-segment-content",31),e.DNE(1,w,1,1,"app-vehicles",32),e.k0s()),2&t){const r=e.XpG(2);e.R7$(),e.Y8G("ngForOf",r.filteredVehicles)}}function J(t,a){if(1&t&&(e.j41(0,"ion-segment-view"),e.DNE(1,N,2,1,"ion-segment-content",26)(2,Y,2,1,"ion-segment-content",27),e.k0s()),2&t){const r=e.XpG();e.R7$(),e.Y8G("ngIf","driver"==r.typeSelect),e.R7$(),e.Y8G("ngIf","vehicle"==r.typeSelect)}}function U(t,a){if(1&t){const r=e.RV6();e.j41(0,"ion-content")(1,"ion-list")(2,"ion-item",34),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.logoutAndGoToSignIn())}),e.EFF(3,"Cerrar Sesi\xf3n"),e.k0s()()()}2&t&&(e.R7$(2),e.Y8G("button",!0)("detail",!1))}const W=[{path:"",component:(()=>{var t;class a{constructor(n,i,l,s,d,h,u){this.translate=n,this.modalController=i,this.busService=l,this.authService=s,this.router=d,this.toastService=h,this.driversService=u,this.typeSelect="driver",this.searchTerm="",this.filteredDrivers=[],this.filteredVehicles=[],this.hasData=!0,this.currentDrivers=[],this.currentVehicles=[],this.isLoading=!0,this.errorMessage=null}ionViewWillEnter(){console.log("Tab3Page: ionViewWillEnter - La p\xe1gina va a ser visible"),this.loadDriversAndBuses()}logoutAndGoToSignIn(){var n=this;return(0,g.A)(function*(){yield n.authService.logout(),n.router.navigate(["/sign-in"])})()}changeLanguage(n){this.translate.use(n="es"==n?"en":"es")}handleSegmentChange(n){const i=n.detail.value;this.typeSelect=i,this.hasData="driver"===i?this.currentDrivers.length>0:this.currentVehicles.length>0}handleRefresh(n){this.loadDriversAndBuses(),setTimeout(()=>{n.target.complete()},2e3)}handleOpenDriverModal(n,i){var l=this;return(0,g.A)(function*(){try{const s=yield l.modalController.create({component:V.K,componentProps:{action:n,driver:i},initialBreakpoint:1,breakpoints:[0,1],cssClass:["loading-truck-options-sheet-modal"]});yield s.present();const{data:d}=yield s.onWillDismiss();if("cancel"===d.action)return}catch{}})()}handleOpenBusModal(n,i){var l=this;return(0,g.A)(function*(){try{const s=yield l.modalController.create({component:M.o,componentProps:{action:n,bus:i},initialBreakpoint:1,breakpoints:[0,1],cssClass:["loading-truck-options-sheet-modal"]});yield s.present();const{data:d}=yield s.onWillDismiss();if("cancel"===d.action)return}catch{}})()}filterData(n){const i=(n.target.value||"").toLowerCase();i?(this.filteredDrivers=this.currentDrivers.filter(l=>{var s,d,h,u;return(null===(s=l.name)||void 0===s?void 0:s.toLowerCase().includes(i))||(null===(d=l.email)||void 0===d?void 0:d.toLowerCase().includes(i))||(null===(h=l.phone)||void 0===h?void 0:h.toLowerCase().includes(i))||(null===(u=l.mobile)||void 0===u?void 0:u.toLowerCase().includes(i))}),this.filteredVehicles=this.currentVehicles.filter(l=>{var s,d;return(null===(s=l.name)||void 0===s?void 0:s.toLowerCase().includes(i))||(null===(d=l.vehicle_color)||void 0===d?void 0:d.toLowerCase().includes(i))||(l.model||"").toLowerCase().includes(i)})):(this.filteredDrivers=[...this.currentDrivers],this.filteredVehicles=[...this.currentVehicles]),this.hasData="first"===this.typeSelect?this.filteredDrivers.length>0:this.filteredVehicles.length>0}loadDriversAndBuses(){this.isLoading=!0,this.errorMessage=null,(0,P.p)({drivers:this.driversService.getAllDrivers().pipe((0,C.T)(n=>{var i;return(null==n||null===(i=n.data)||void 0===i?void 0:i.school_drivers)||[]}),(0,f.W)(n=>(console.error("Error fetching drivers:",n),(0,F.$)(()=>new Error(n.message||"Failed to load drivers"))))),buses:this.busService.getAllBuses().pipe((0,C.T)(n=>{var i;return(null==n||null===(i=n.data)||void 0===i?void 0:i.school_buses)||[]}),(0,f.W)(n=>(console.error("Error fetching buses:",n),(0,F.$)(()=>new Error(n.message||"Failed to load buses")))))}).pipe((0,$.M)(n=>{this.currentDrivers=n.drivers,this.currentVehicles=n.buses,this.filteredDrivers=[...this.currentDrivers],this.filteredVehicles=[...this.currentVehicles],this.hasData="first"===this.typeSelect?this.filteredDrivers.length>0:this.filteredVehicles.length>0}),(0,f.W)(n=>(console.error("Failed to load drivers or buses:",n),this.errorMessage="Error al cargar los conductores o autobuses: "+(n.message||"Error desconocido"),(0,E.of)(null))),(0,y.j)(()=>{this.isLoading=!1})).subscribe()}}return(t=a).\u0275fac=function(n){return new(n||t)(e.rXU(p.c$),e.rXU(o.W3),e.rXU(T.b),e.rXU(I.u),e.rXU(k.t),e.rXU(j.f),e.rXU(_.h))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-tab2"]],standalone:!1,decls:29,vars:7,consts:[[1,"i-header"],[1,"i-toolbar-inner"],[1,"i-toolbar"],["size","large"],["size","auto"],["id","driver-bus-button"],["alt","Silhouette of a person's head","src","https://ionicframework.com/docs/img/demos/avatar.svg"],[1,"segment"],["size","mediun","mode","ios","show-clear-button","always","clear-icon","trash-bin","placeholder","Buscar chofer o veh\xedculo",3,"ionInput"],["size","large","mode","ios",3,"ngModelChange","ionChange","ngModel"],["value","driver","content-id","driver"],["value","vehicle","content-id","vehicle"],[1,"",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["class","loading-state ion-text-center",4,"ngIf"],["class","error-state ion-text-center",4,"ngIf"],["class","empty-state ion-text-center",4,"ngIf"],[4,"ngIf"],["trigger","driver-bus-button",3,"dismissOnSelect"],[1,"loading-state","ion-text-center"],["name","circles"],[1,"error-state","ion-text-center"],["name","warning-outline","color","danger"],[3,"click"],[1,"empty-state","ion-text-center"],["name","information-circle-outline","color","medium"],["id","driver",4,"ngIf"],["id","vehicle",4,"ngIf"],["id","driver"],[3,"currentDriver","handleActionDriver",4,"ngFor","ngForOf"],[3,"handleActionDriver","currentDriver"],["id","vehicle"],[3,"currentVehicle","handleActionDriver",4,"ngFor","ngForOf"],[3,"handleActionDriver","currentVehicle"],[3,"click","button","detail"]],template:function(n,i){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"ion-row",2)(4,"ion-col")(5,"ion-title",3),e.EFF(6," Choferes y Vehiculos "),e.k0s()(),e.j41(7,"ion-col",4)(8,"div")(9,"ion-avatar",5),e.nrm(10,"img",6),e.k0s()()()()(),e.j41(11,"div",7)(12,"ion-searchbar",8),e.bIt("ionInput",function(s){return i.filterData(s)}),e.k0s(),e.j41(13,"ion-segment",9),e.mxI("ngModelChange",function(s){return e.DH7(i.typeSelect,s)||(i.typeSelect=s),s}),e.bIt("ionChange",function(s){return i.handleSegmentChange(s)}),e.j41(14,"ion-segment-button",10)(15,"ion-label"),e.EFF(16,"Choferes "),e.k0s()(),e.j41(17,"ion-segment-button",11)(18,"ion-label"),e.EFF(19,"Vehiculos"),e.k0s()()()()()(),e.j41(20,"ion-content",12)(21,"ion-refresher",13),e.bIt("ionRefresh",function(s){return i.handleRefresh(s)}),e.nrm(22,"ion-refresher-content"),e.k0s(),e.DNE(23,B,4,0,"div",14)(24,L,6,1,"div",15)(25,O,4,0,"div",16)(26,J,3,2,"ion-segment-view",17),e.k0s(),e.j41(27,"ion-popover",18),e.DNE(28,U,4,2,"ng-template"),e.k0s()),2&n&&(e.R7$(13),e.R50("ngModel",i.typeSelect),e.R7$(7),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",i.errorMessage),e.R7$(),e.Y8G("ngIf",!i.isLoading&&!i.hasData),e.R7$(),e.Y8G("ngIf",!i.isLoading&&i.hasData),e.R7$(),e.Y8G("dismissOnSelect",!0))},dependencies:[o.mC,o.Jm,o.hU,o.W9,o.eU,o.iq,o.uz,o.he,o.nf,o.To,o.Ki,o.ln,o.S1,o.Gp,o.eP,o.Z$,o.pf,o.w2,o.BC,o.ai,o.CF,o.Je,o.Gw,v.G,v.I,m.BC,m.vS,A,x],styles:["ion-toolbar[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{margin:0 11px 7px}"]}),a})()}];let z=(()=>{var t;class a{}return(t=a).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[D.m.forChild(W),D.m]}),a})();var H=c(5218),K=c(8041);function R(t){return new H.s(t,"./assets/translate/",".json")}let Z=(()=>{var t;class a{}return(t=a).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({providers:[_.h,T.b],imports:[o.bv,v.D,m.YN,z,m.X1,p.h.forRoot({defaultLanguage:"es",loader:{provide:p.Wr,useFactory:R,deps:[K.a]}})]}),a})()}}]);