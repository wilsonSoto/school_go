"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5113],{5113:(V,v,a)=>{a.r(v),a.d(v,{Tab3PageModule:()=>y});var n=a(7125),g=a(8834),m=a(9417),f=a(5528),b=a(467),T=a(1432),e=a(9498),p=a(2167),_=a(8397),R=a(3975),P=a(7291),j=a(3067),M=a(5690);function F(i,l){1&i&&(e.j41(0,"div",15),e.nrm(1,"ion-spinner",16),e.j41(2,"p"),e.EFF(3,"Cargando Rutas..."),e.k0s()())}function L(i,l){if(1&i){const s=e.RV6();e.j41(0,"div",17),e.nrm(1,"ion-icon",18),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"ion-button",19),e.bIt("click",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.getAllRoute())}),e.EFF(5,"Reintentar"),e.k0s()()}if(2&i){const s=e.XpG();e.R7$(3),e.JRh(s.errorMessage)}}function G(i,l){1&i&&(e.j41(0,"div",20),e.nrm(1,"ion-icon",21),e.j41(2,"p"),e.EFF(3,"No hay informaci\xf3n disponible para esta secci\xf3n."),e.k0s()())}function $(i,l){if(1&i){const s=e.RV6();e.j41(0,"app-all-route",23),e.bIt("click",function(){const t=e.eBV(s).$implicit,r=e.XpG(2);return e.Njj(r.handleOpenRouteModal("edit",t))}),e.k0s()}2&i&&e.Y8G("route",l.$implicit)}function C(i,l){if(1&i&&(e.j41(0,"ion-list"),e.DNE(1,$,1,1,"app-all-route",22),e.k0s()),2&i){const s=e.XpG();e.R7$(),e.Y8G("ngForOf",s.filteredRoutes)}}function E(i,l){if(1&i){const s=e.RV6();e.j41(0,"ion-content")(1,"ion-list")(2,"ion-item",24),e.bIt("click",function(){e.eBV(s);const t=e.XpG();return e.Njj(t.logoutAndGoToSignIn())}),e.EFF(3,"Cerrar Sesi\xf3n"),e.k0s()()()}2&i&&(e.R7$(2),e.Y8G("button",!0)("detail",!1))}const I=[{path:"",component:(()=>{var i;class l{constructor(o,t,r,c,u,d){this.routeService=o,this.toastService=t,this.router=r,this.modalController=c,this.storage=u,this.authService=d,this.school_routes=[],this.token="",this.searchTerm="",this.filteredRoutes=[],this.hasData=!0,this.isLoading=!0,this.errorMessage=null}ngOnInit(){const o=this;this.storage.get(T.NS.FCM_TOKEN).then(t=>{o.token=JSON.stringify(t)})}logoutAndGoToSignIn(){var o=this;return(0,b.A)(function*(){yield o.authService.logout(),o.router.navigate(["/sign-in"])})()}handleRefresh(o){this.getAllRoute(),setTimeout(()=>{o.target.complete()},2e3)}ionViewWillEnter(){console.log("Tab3Page: ionViewWillEnter - La p\xe1gina va a ser visible"),this.getAllRoute()}ionViewDidEnter(){console.log("Tab3Page: ionViewDidEnter - La p\xe1gina ya es visible")}ionViewDidLeave(){console.log("Tab3Page: ionViewDidLeave - La p\xe1gina ha dejado de ser visible")}getAllRoute(){this.isLoading=!0,this.errorMessage=null,this.routeService.getAllroute().subscribe({next:o=>{this.isLoading=!1,this.school_routes=o.data.school_routes,this.filteredRoutes=[...this.school_routes],this.hasData=this.filteredRoutes.length>0},error:o=>{var t,r;this.isLoading=!1,this.errorMessage="Error al cargar las rutas: "+(o.message||"Error desconocido");const c=(null==o||null===(t=o.error)||void 0===t||null===(t=t.error)||void 0===t?void 0:t.message)||(null==o||null===(r=o.error)||void 0===r?void 0:r.error)||(null==o?void 0:o.message)||"Error desconocido";this.toastService.presentToast(c)}})}filterRoutes(o){const t=(o.target.value||"").toLowerCase();this.filteredRoutes=t?this.school_routes.filter(r=>{var c,u,d;const S=(null===(c=r.name)||void 0===c?void 0:c.toLowerCase())||"",D=(null===(u=r.school_driver)||void 0===u||null===(u=u.name)||void 0===u?void 0:u.toLowerCase())||"",N=(null===(d=r.students)||void 0===d?void 0:d.map(O=>{var h;return null===(h=O.name)||void 0===h?void 0:h.toLowerCase()}).join(" "))||"";return S.includes(t)||D.includes(t)||N.includes(t)}):[...this.school_routes],this.hasData=this.filteredRoutes.length>0}getAllRoute2222222(){this.isLoading=!0,this.errorMessage=null,this.routeService.getAllroute().subscribe({next:o=>{this.isLoading=!1,this.school_routes=o.data.school_routes},error:o=>{var t,r;this.isLoading=!1,this.errorMessage="Error al cargar las rutas: "+(o.message||"Error desconocido");const c=(null==o||null===(t=o.error)||void 0===t||null===(t=t.error)||void 0===t?void 0:t.message)||(null==o||null===(r=o.error)||void 0===r?void 0:r.error)||(null==o?void 0:o.message)||"Error desconocido";this.toastService.presentToast(c)}})}handleOpenRouteModal(o,t){t.id||console.log("error id route"),this.router.navigate([`/route/${t.id}`],{queryParams:{action:o}})}}return(i=l).\u0275fac=function(o){return new(o||i)(e.rXU(p.v),e.rXU(_.f),e.rXU(R.t),e.rXU(n.W3),e.rXU(P.n),e.rXU(j.u))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-tab3"]],standalone:!1,decls:21,vars:6,consts:[[1,"i-header"],[1,"i-toolbar-inner"],[1,"i-toolbar"],["size","large"],["size","auto"],["id","popover-button"],["alt","Silhouette of a person's head","src","https://ionicframework.com/docs/img/demos/avatar.svg"],["size","mediun","mode","ios","show-clear-button","always","clear-icon","trash-bin","placeholder","Buscar por ruta, chofer o estudiante",3,"ionInput"],[1,"",3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["class","loading-state ion-text-center",4,"ngIf"],["class","error-state ion-text-center",4,"ngIf"],["class","empty-state ion-text-center",4,"ngIf"],[4,"ngIf"],["trigger","popover-button",3,"dismissOnSelect"],[1,"loading-state","ion-text-center"],["name","circles"],[1,"error-state","ion-text-center"],["name","warning-outline","color","danger"],[3,"click"],[1,"empty-state","ion-text-center"],["name","information-circle-outline","color","medium"],[3,"route","click",4,"ngFor","ngForOf"],[3,"click","route"],[3,"click","button","detail"]],template:function(o,t){1&o&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"div",1)(3,"ion-row",2)(4,"ion-col")(5,"ion-title",3),e.EFF(6," Planificacion de Rutas "),e.k0s()(),e.j41(7,"ion-col",4)(8,"div")(9,"ion-avatar",5),e.nrm(10,"img",6),e.k0s()()()()(),e.j41(11,"ion-searchbar",7),e.bIt("ionInput",function(c){return t.filterRoutes(c)}),e.k0s()()(),e.j41(12,"ion-content",8)(13,"ion-refresher",9),e.bIt("ionRefresh",function(c){return t.handleRefresh(c)}),e.nrm(14,"ion-refresher-content"),e.k0s(),e.DNE(15,F,4,0,"div",10)(16,L,6,1,"div",11)(17,G,4,0,"div",12)(18,C,2,1,"ion-list",13),e.k0s(),e.j41(19,"ion-popover",14),e.DNE(20,E,4,2,"ng-template"),e.k0s()),2&o&&(e.R7$(12),e.Y8G("fullscreen",!0),e.R7$(3),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",t.errorMessage),e.R7$(),e.Y8G("ngIf",!t.isLoading&&!t.hasData),e.R7$(),e.Y8G("ngIf",!t.isLoading&&t.hasData),e.R7$(),e.Y8G("dismissOnSelect",!0))},dependencies:[n.mC,n.Jm,n.hU,n.W9,n.eU,n.iq,n.uz,n.nf,n.To,n.Ki,n.ln,n.S1,n.w2,n.BC,n.ai,n.CF,n.Gw,g.G,g.I,M.E],styles:["ion-modal[_ngcontent-%COMP%]{--height: 50%;--border-radius: 16px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1)}ion-modal[_ngcontent-%COMP%]::part(backdrop){background:var(--ion-background-color);opacity:1}ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: rgb(14 116 144);--color: var(--ion-text-placeholder-color)}"]}),l})()}];let x=(()=>{var i;class l{}return(i=l).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[f.m.forChild(I),f.m]}),l})();var k=a(1150);let y=(()=>{var i;class l{}return(i=l).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({providers:[p.v],imports:[n.bv,g.D,m.YN,x,m.X1,k.G]}),l})()}}]);